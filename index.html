<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÁîüÂØ´ÁúüÁµ±Ë®àÁ≥ªÁµ± - Ê´ªÂùÇ46 Â∞àÂ±¨Áâà</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .photo-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; }
        .item-slot {
            aspect-ratio: 2 / 1; 
            display: flex; align-items: center; justify-content: center;
            border-radius: 6px; font-size: 11px; font-weight: 800;
            transition: all 0.2s ease; letter-spacing: -0.5px;
        }
        .expand-enter-active, .expand-leave-active { transition: all 0.25s ease; max-height: 1000px; overflow: hidden; }
        .expand-enter-from, .expand-leave-to { max-height: 0; opacity: 0; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen pb-10">
    <div id="app">
        <nav class="bg-white shadow-sm p-4 sticky top-0 z-30 border-b border-gray-100">
            <div class="max-w-xl mx-auto flex justify-between items-center">
                <h1 class="text-lg font-black text-gray-800" @click="currentMember = null">üå∏ SAKURA <span class="text-pink-500">COLLECTION</span></h1>
                <button @click="showInput = !showInput" class="text-[10px] bg-slate-800 text-white px-3 py-1.5 rounded-full font-bold uppercase">Admin</button>
            </div>
        </nav>

        <main class="max-w-xl mx-auto p-3">
            <div v-if="showInput" class="bg-white p-5 rounded-2xl shadow-xl mb-6 border-2 border-pink-50">
                <div class="space-y-3">
                    <input v-model="newItem.name" list="member-list" placeholder="Ëº∏ÂÖ•ÊàñÈÅ∏ÊìáÊàêÂì° (Â¶ÇÔºöÁü≥Ê£ÆÁíÉËä±)" class="w-full border p-2.5 rounded-xl outline-none focus:ring-2 focus:ring-pink-400 text-sm">
                    <datalist id="member-list">
                        <option v-for="name in presetMembers" :value="name"></option>
                    </datalist>

                    <select v-model="selectedPreset" @change="onSeriesSelect" class="w-full border p-2.5 rounded-xl outline-none focus:ring-2 focus:ring-pink-400 text-sm bg-white">
                        <option value="">-- ÈªûÊ≠§ÈÅ∏ÊìáÂÖßÂª∫Á≥ªÂàó (ÂÖ±{{presetSeries.length}}È†Ö) --</option>
                        <option v-for="s in presetSeries" :value="s">{{ s }}</option>
                        <option value="custom">ÊâãÂãïËº∏ÂÖ•ÂÖ∂‰ªñ...</option>
                    </select>

                    <input v-if="selectedPreset === 'custom' || !selectedPreset" v-model="newItem.series" type="text" placeholder="ÊâãÂãïËº∏ÂÖ•Á≥ªÂàóÂêçÁ®±" class="w-full border p-2.5 rounded-xl outline-none focus:ring-2 focus:ring-pink-400 text-sm">
                    
                    <button @click="addBatchItems" class="w-full bg-pink-500 text-white p-2.5 rounded-xl font-bold text-sm shadow-lg">Âø´ÈÄüÊñ∞Â¢ûÁ≥ªÂàó (4Á®Æ)</button>
                </div>
                <div class="flex justify-between mt-4 border-t pt-3">
                    <button @click="exportData" class="text-[10px] text-blue-500 font-bold">ÂÇô‰ªΩË≥áÊñô</button>
                    <button @click="clearAll" class="text-[10px] text-red-300 font-bold">Ê∏ÖÁ©∫Ë≥áÊñôÂ∫´</button>
                </div>
            </div>

            <div v-if="!currentMember" class="grid grid-cols-2 gap-3 mt-2">
                <div v-for="name in memberList" :key="name" @click="currentMember = name" class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100 active:scale-95 transition text-center">
                    <div class="font-black text-gray-700 text-base italic">{{ name }}</div>
                    <div class="text-[9px] text-pink-400 font-bold mt-1 uppercase tracking-widest">{{ getMemberOwnedCount(name) }} Collected</div>
                </div>
            </div>

            <div v-else>
                <div class="flex items-center justify-between mb-4 px-1">
                    <div class="flex items-center">
                        <button @click="currentMember = null" class="text-gray-300 font-bold mr-3 text-xl leading-none">‚Äπ</button>
                        <h2 class="text-xl font-black text-gray-800 italic uppercase">{{ currentMember }}</h2>
                    </div>
                    <button @click="toggleAll" class="text-[9px] bg-pink-50 text-pink-500 px-2 py-1 rounded-md font-black uppercase tracking-tighter">{{ allExpanded ? 'Êî∂Âêà' : 'Â±ïÈñã' }}</button>
                </div>
                
                <div v-for="(items, seriesName) in memberSeriesGroup" :key="seriesName" class="mb-2.5">
                    <div @click="toggleSeries(seriesName)" class="bg-white px-4 py-3.5 rounded-xl shadow-sm border border-gray-100 flex justify-between items-center cursor-pointer active:bg-gray-50">
                        <div class="flex items-center overflow-hidden">
                            <span class="text-[8px] mr-2.5 text-pink-400 transition-transform duration-200" :class="{'rotate-90': expandedSeries.has(seriesName)}">‚ñ∂</span>
                            <h3 class="text-xs font-bold text-gray-600 truncate mr-2">{{ seriesName }}</h3>
                        </div>
                        <div class="flex items-center gap-3 shrink-0">
                            <div class="bg-gray-50 px-2 py-0.5 rounded text-[10px] font-black" :class="getProgress(items).count === 4 ? 'text-green-500' : 'text-pink-400'">{{ getProgress(items).count }}/4</div>
                            <button @click.stop="removeSeries(seriesName)" class="text-gray-200 hover:text-red-400 transition"><svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg></button>
                        </div>
                    </div>

                    <transition name="expand">
                        <div v-if="expandedSeries.has(seriesName)" class="bg-white/40 p-3 rounded-b-xl border-x border-b border-gray-100 mx-1">
                            <div class="mb-3 relative rounded-lg overflow-hidden bg-slate-100 flex items-center justify-center">
                                <img v-if="seriesImages[currentMember + seriesName]" :src="seriesImages[currentMember + seriesName]" @click="zoomedImg = seriesImages[currentMember + seriesName]" class="w-full h-auto max-h-[350px] object-contain">
                                <label v-else class="py-5 cursor-pointer w-full text-center">
                                    <span class="text-[10px] text-gray-300 font-bold uppercase tracking-widest">+ Upload Set Photo</span>
                                    <input type="file" class="hidden" @change="(e) => handleSeriesImageUpload(e, currentMember + seriesName)" accept="image/*">
                                </label>
                            </div>
                            <div class="photo-grid px-1 pb-1">
                                <div v-for="item in items" :key="item.id" @click="toggleItem(item.id)" class="item-slot border-2" :class="ownedIds.has(item.id) ? 'border-pink-500 bg-pink-500 text-white shadow-sm' : 'border-gray-100 bg-white text-gray-300'">{{ item.type }}</div>
                            </div>
                        </div>
                    </transition>
                </div>
            </div>
        </main>
        <div v-if="zoomedImg" @click="zoomedImg = null" class="fixed inset-0 bg-black/95 z-50 flex items-center justify-center p-2"><img :src="zoomedImg" class="max-w-full max-h-full object-contain"></div>
    </div>

    <script>
        const { createApp } = Vue;
        createApp({
            data() {
                return {
                    presetMembers: ['Áü≥Ê£ÆÁíÉËä±', 'ÈÅ†Ëó§ÁêÜÂ≠ê', 'Â∞èÁî∞ÂÄâÈ∫óÂ•à', 'Â∞èÂ≥∂Âá™Á¥ó', 'Ë∞∑Âè£ÊÑõÂ≠£', '‰∏≠Â∂ãÂÑ™Êúà', 'ÁöÑÈáéÁæéÈùí', 'Âêë‰∫ïÁ¥îËëâ', 'Êùë‰∫ïÂÑ™', 'ÊùëÂ±±ÁæéÁæΩ', 'Â±±‰∏ãÁû≥Êúà', 'Áî∞Êùë‰øù‰πÉ', 'Â±±Ô®ëÂ§©', 'Ê£ÆÁî∞„Å≤„Åã„Çã', 'ÂÆàÂ±ãÈ∫óÂ•à', 'Ëó§ÂêâÂ§èÈà¥'],
                    presetSeries: ['5th Single „ÄåÊ°úÊúà„ÄçÂ∞ÅÂÖ•', '„ÄåÂ§è„ÅÆËøëÈÅì„Äç MVË°£Ë£Ö', '„ÄåÂ§è„ÅÆËøëÈÅì„Äç MV Âà∂Êúç', '„ÄåBAN„Äç MVË°£Ë£Ö', '2023Âπ¥ ÂÜ¨ÁßÅÊúç„Ç≥„Éº„Éá', '‰∏âÊúüÁîü„Éñ„ÉÉ„ÇØ„É¨„ÉÉ„ÉàË°£Ë£Ö', '„Çπ„Éº„ÉÑ„Ç≥„Éº„Éá', '„Ç´„É©„Éº„Ç≥„Éº„Éá', '6th Single „ÄåStart over!„ÄçÂ∞ÅÂÖ•', '„Äå3rd TOUR 2023„Äç „Ç™„Éº„Éó„Éã„É≥„Ç∞Ë°£Ë£Ö', '„ÄåStart over!„Äç „Ç∏„É£„Ç±„ÉÉ„ÉàÂÜôÁúüË°£Ë£Ö', '„ÄåÈùôÂØÇ„ÅÆÊö¥Âäõ„Äç MVË°£Ë£Ö', '„Çµ„Éû„Éº„ÉØ„É≥„Éî„Éº„Çπ', '„Éá„Éã„É†„Ç≥„Éº„Éá', '2023Âπ¥ „Éè„É≠„Ç¶„Ç£„É≥Ë°£Ë£Ö', '7th Single „ÄåÊâøË™çÊ¨≤Ê±Ç„ÄçÂ∞ÅÂÖ•', '2023Âπ¥ „ÇØ„É™„Çπ„Éû„Çπ„Çµ„É≥„ÇøË°£Ë£Ö', '„Äå3rd TOUR 2023„Äç ÁôΩ„Çπ„Éº„ÉÑË°£Ë£Ö', '2023Âπ¥Â§è„Éï„Çß„ÇπË°£Ë£Ö', "„ÄåNobody's fault„ÄçMVË°£Ë£Ö", '2023Âπ¥ Ë™≠Êõ∏„Ç≥„Éº„Éá', '2024Âπ¥ ÊåØË¢ñË°£Ë£Ö', '„ÄåÊâøË™çÊ¨≤Ê±Ç„Äç „Ç∏„É£„Ç±„ÉÉ„ÉàÂÜôÁúüË°£Ë£Ö', '„Äå„Éû„É¢„É™„Éì„Éà„Äç MVË°£Ë£Ö', '3rd Single BACKS LIVE!!', '„Åä„ÅÜ„Å°„Ç≥„Éº„Éá', '„Ç∏„É£„É≥„Éó„Çπ„Éº„ÉÑ', '8th Single „Äå‰ΩïÊ≠≥„ÅÆÈ†É„Å´Êàª„Çä„Åü„ÅÑ„ÅÆ„Åã?„Äç Â∞ÅÂÖ•', '„Äå3rd TOUR 2023„Äç „Éî„É≥„ÇØË°£Ë£Ö', '[3rd YEAR ANNIVERSARY LIVE„Äç „É©„Ç§„ÉñË°£Ë£Ö (4th TOUR ÂèëÂîÆ)', '„Äå‰ΩïÊ≠≥„ÅÆÈ†É„Å´Êàª„Çä„Åü„ÅÑ„ÅÆ„Åã?„Äç „Ç∏„É£„Ç±„ÉÉ„ÉàÂÜôÁúüË°£Ë£Ö', '2024Âπ¥ Êò•ÁßÅÊúç„Ç≥„Éº„Éá', '„Äå‰ΩïÂ∫¶ LOVE SONG „ÅÆÊ≠åË©û„ÇíË™≠„ÅøËøî„Åó„Åü„Å†„Çç„ÅÜ„Äç MVË°£Ë£Ö', '„Äå7th Single BACKS LIVE!!„Äç „Ç™„Éº„Éó„Éã„É≥„Ç∞Ë°£Ë£Ö', '„ÄåÊ≤π„ÇíÊ≥®„Åõ!„Äç MVË°£Ë£Ö', '„ÄåÂ∞èÊûóÁî±‰æù ÂçíÊ•≠„Ç≥„É≥„Çµ„Éº„Éà„Äç „É©„Ç§„ÉñË°£Ë£Ö', '„Ç´„É©„Éº„Éá„Éã„É†', '2024Âπ¥Êµ¥Ë°£', '„ÄåÂ∞èÊûóÁî±‰æù ÂçíÊ•≠„Ç≥„É≥„Çµ„Éº„Éà„Äç Ëµ§Ë°£Ë£Ö', '„Äå3rd TOUR 2023„Äç „É©„Ç§„ÉñË°£Ë£Ö', '„Äê‰ºöÂ†¥‰∫àÁ¥ÑÁâπÂÖ∏„Äë Êù±‰∫¨„Éâ„Éº„É†ÈôêÂÆö„É°„É≥„Éê„ÉºÁîüÂÜôÁúü(„ÉÅ„É•„Ç¶)', 'Êù±‰∫¨„Éâ„Éº„É†ÂÆåÂ£≤Âæ°Á§ºË®òÂøµ!! „É©„Ç§„Éñ‰ºöÂ†¥ÊíÆ„Çä„Åä„Çç„Åó„Éó„É¨„Éü„Ç¢„É†ÁîüÂÜôÁúü(„Ç¶„Ç®„Çπ„Éà)', '9th Single „ÄåËá™Ê•≠Ëá™Âæó„ÄçÂ∞ÅÂÖ•', 'È∫¶„Çè„ÇâÂ∏ΩÂ≠ê„Ç≥„Éº„Éá', '2023Âπ¥ Âπ¥Êú´Ê≠åÂî±Ë°£Ë£Ö', '„ÄåËá™Ê•≠Ëá™Âæó„Äç „Ç∏„É£„Ç±„ÉÉ„ÉàÂÜôÁúüË°£Ë£Ö', '„Äå8th Single BACKS LIVE!!„Äç „É©„Ç§„ÉñË°£Ë£Ö', '„ÄåÊÑõ„ÅóÂêà„ÅÑ„Å™„Åï„ÅÑ„Äç MV „Ç´„É©„Éï„É´Ë°£Ë£Ö', '„ÄåÊÑõ„ÅóÂêà„ÅÑ„Å™„Åï„ÅÑ„Äç MV ÈªíË°£Ë£Ö', 'T„Ç∑„É£„ÉÑ„Ç≥„Éº„Éá', '„ÄåÂºï„Åç„Åì„ÇÇ„ÇãÊôÇÈñì„ÅØ„Å™„ÅÑ„Äç MV Ë°£Ë£Ö', '„Äå4th ARENA TOUR 2024„Äç „É©„Ç§„ÉñË°£Ë£Ö', '„ÉØ„Ç§„Ç∑„É£„ÉÑ„Ç≥„Éº„Éá', '2024Âπ¥ „Éè„É≠„Ç¶„Ç£„É≥Ë°£Ë£Ö', '„Ç´„É©„Éº„Éã„ÉÉ„Éà„Ç≥„Éº„Éá', '10th Single I want tomorrow to come„ÄçÂ∞ÅÂÖ•', '2024Âπ¥ „ÇØ„É™„Çπ„Éû„Çπ„Çµ„É≥„ÇøË°£Ë£Ö', '[3rd YEAR ANNIVERSARY LIVE„Äç „É©„Ç§„ÉñË°£Ë£Ö (4th YEAR ÂèëÂîÆ)', '„Äå4th ARENA TOUR IN Êù±‰∫¨„Éâ„Éº„É†„Äç „Ç™„Éº„Éó„Éã„É≥„Ç∞Ë°£Ë£Ö', '„Å©„ÅÜ„Å∂„Å§ÁùÄ„Åê„Çã„Åø', '„ÄåÂÉï„ÅØÂÉï„ÇíÂ•Ω„Åç„Å´„Å™„Çå„Å™„ÅÑ„Äç MVË°£Ë£Ö', '„Äå9th Single BACKS LIVE!!„Äç „Ç™„Éº„Éó„Éã„É≥„Ç∞Ë°£Ë£Ö', '„Éû„Éï„É©„Éº„Ç≥„Éº„Éá', '[I want tomorrow to come„Äç „Ç∏„É£„Ç±„ÉÉ„ÉàÂÜôÁúüË°£Ë£Ö', '„ÄåÊú¨Ë≥™ÁöÑ„Å™„Åì„Å®„Äç MVË°£Ë£Ö', 'Á¶èË¢ã 2025 „ÄåÊù±‰∫¨„Éâ„Éº„É†„Äç „Ç™„Éº„Éó„Éã„É≥„Ç∞Ë°£Ë£Ö Êñ∞„Ç´„ÉÉ„Éà', '2025Âπ¥ÊåØË¢ñ', '2023Âπ¥ Âπ¥Êú´Ë°£Ë£Ö', '„ÅÑ„Å¨„Åø„Åø„Ç≥„Éº„Éá', '11th Single „ÄåUDAGAWA GENERATION„ÄçÂ∞ÅÂÖ•', '„ÄåUDAGAWA GENERATION„Äç „Ç∏„É£„Ç±„ÉÉ„ÉàÂÜôÁúüË°£Ë£Ö', '„ÄåUDAGAWA GENERATION„ÄçMVË°£Ë£Ö', '„ÄåNightmare ÁóáÂÄôÁæ§„ÄçMVË°£Ë£Ö', '2024Âπ¥Â§è„Éï„Çß„ÇπË°£Ë£Ö', '„É¢„Éº„Éâ„Ç≥„Éº„Éá', 'ÂÜ¨ÁßÅÊúç„Ç≥„Éº„Éá', '„Äå4th ARENA TOUR„Äç „Ç™„Éº„Éó„Éã„É≥„Ç∞Ë°£Ë£Ö', '„Äå4th YEAR ANNIVERSARY LIVE„Äç „É©„Ç§„ÉñË°£Ë£Ö', '„Äå4th ARENA TOUR„Äç „É©„Ç§„ÉñË°£Ë£Ö', '„Éç„ÇØ„Çø„Ç§„Ç≥„Éº„Éá', '2nd Album „ÄåAddiction„ÄçÂ∞ÅÂÖ•', '„ÄåAddiction„Äç MVË°£Ë£Ö', '„Äå‰∏âÊúüÁîü„É©„Ç§„Éñ„Äç „Ç™„Éº„Éó„Éã„É≥„Ç∞Ë°£Ë£Ö', '„É¨„Ç∂„Éº„Ç∏„É£„Ç±„ÉÉ„Éà„Ç≥„Éº„Éá', '12th Single „ÄåMake or Break„ÄçÂ∞ÅÂÖ•', '2025Âπ¥Êµ¥Ë°£', '„Äå4th ARENA TOUR IN Êù±‰∫¨„Éâ„Éº„É†„Äç „É©„Ç§„ÉñË°£Ë£Ö', '2024Âπ¥ Â§è„Éï„Çß„ÇπË°£Ë£Ö', '„ÄåÊ∏ØÂçÄ„Éë„Çª„É™„Äç MVË°£Ë£Ö', '[10th Single BACKS LIVE!!„Äç „É©„Ç§„ÉñË°£Ë£Ö', '„Éù„É≠„Ç∑„É£„ÉÑ„Ç≥„Éº„Éá', '„ÇØ„É©„Ç∑„ÉÉ„ÇØ„Ç≥„Éº„Éá', '„ÄåMake or Break„Äç „Ç∏„É£„Ç±„ÉÉ„ÉàÂÜôÁúüË°£Ë£Ö', '„Äå5th TOUR 2025 Addiction‚Äù„Äç „É©„Ç§„ÉñË°£Ë£Ö"', '„Äå‰∏âÊúüÁîü„É©„Ç§„Éñ„ÄçË°£Ë£Ö', '„ÉÅ„Çß„ÉÉ„ÇØ„Ç≥„Éº„Éá', '„Äå12th Single BACKS LIVE!!„Äç„É©„Ç§„ÉñË°£Ë£Ö', '„Äå5th TOUR 2025 ‚ÄúAddiction‚Äù„ÄçÈªëË°£Ë£Ö', '„Éë„Ç§„É¨„Éº„ÉÑË°£Ë£Ö', 'ÂÜ¨Êúç', '„ÄåUnhappy birthdayÊßãÊñá„ÄçMVË°£Ë£Ö', '„ÄåUnhappy birthdayÊßãÊñá„Äç„Ç∏„É£„Ç±„ÉÉ„ÉàÂÜôÁúüË°£Ë£Ö', '„Äå12th Single BACKS LIVE!!„ÄçÈªëË°£Ë£Ö', '2025Âπ¥ „Çµ„É≥„ÇøË°£Ë£Ö', '„Çπ„Çø„Ç§„É™„É≥„Ç∞Âà∂Êúç', '2026Âπ¥ ÊåØË¢ñ', '„Ç∏„É£„Éº„Ç∏', '2026Âπ¥ „Éê„É¨„É≥„Çø„Ç§„É≥„Ç≥„Éº„Éá', 'Á¶èË¢ã 2026 „ÄåÊ∏ØÂçÄ„Éë„Çª„É™„Äç MVÊñ∞„Ç´„ÉÉ„Éà'],
                    showInput: false, selectedPreset: '', currentMember: null, zoomedImg: null, newItem: { name: '', series: '' }, rawItems: [], ownedIds: new Set(), seriesImages: {}, expandedSeries: new Set()
                }
            },
            computed: {
                memberList() { return [...new Set(this.rawItems.map(i => i.name))]; },
                memberSeriesGroup() {
                    if (!this.currentMember) return {};
                    const filtered = this.rawItems.filter(i => i.name === this.currentMember);
                    return filtered.reduce((acc, item) => {
                        if (!acc[item.series]) acc[item.series] = [];
                        acc[item.series].push(item);
                        return acc;
                    }, {});
                },
                allExpanded() {
                    const total = Object.keys(this.memberSeriesGroup).length;
                    return total > 0 && this.expandedSeries.size === total;
                }
            },
            mounted() { this.loadData(); },
            methods: {
                onSeriesSelect() { if (this.selectedPreset !== 'custom' && this.selectedPreset !== '') this.newItem.series = this.selectedPreset; else this.newItem.series = ''; },
                toggleSeries(name) { if (this.expandedSeries.has(name)) this.expandedSeries.delete(name); else this.expandedSeries.add(name); },
                toggleAll() { if (this.allExpanded) this.expandedSeries.clear(); else Object.keys(this.memberSeriesGroup).forEach(n => this.expandedSeries.add(n)); },
                loadData() {
                    const savedOwned = localStorage.getItem('owned_photos'); if (savedOwned) this.ownedIds = new Set(JSON.parse(savedOwned));
                    const savedItems = localStorage.getItem('raw_items'); if (savedItems) this.rawItems = JSON.parse(savedItems);
                    const savedSeriesImgs = localStorage.getItem('series_images'); if (savedSeriesImgs) this.seriesImages = JSON.parse(savedSeriesImgs);
                },
                addBatchItems() {
                    if (!this.newItem.name || !this.newItem.series) return;
                    const types = ['„É®„É™', '„ÉÅ„É•„Ç¶', '„Éí„Ç≠', 'Â∫ß„Çä'];
                    types.forEach(type => {
                        const id = `id-${Date.now()}-${Math.random()}`;
                        this.rawItems.push({ id, name: this.newItem.name, series: this.newItem.series, type });
                    });
                    this.saveData();
                },
                removeSeries(seriesName) { if(confirm(`Delete "${seriesName}"?`)) { this.rawItems = this.rawItems.filter(i => !(i.name === this.currentMember && i.series === seriesName)); this.expandedSeries.delete(seriesName); this.saveData(); } },
                handleSeriesImageUpload(event, key) {
                    const file = event.target.files[0]; if (!file) return;
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const img = new Image(); img.onload = () => {
                            const canvas = document.createElement('canvas'); const MAX_WIDTH = 1000;
                            let width = img.width; let height = img.height; if (width > MAX_WIDTH) { height *= MAX_WIDTH / width; width = MAX_WIDTH; }
                            canvas.width = width; canvas.height = height; const ctx = canvas.getContext('2d'); ctx.drawImage(img, 0, 0, width, height);
                            this.seriesImages[key] = canvas.toDataURL('image/jpeg', 0.6); this.saveData();
                        };
                        img.src = e.target.result;
                    };
                    reader.readAsDataURL(file);
                },
                toggleItem(id) { if (this.ownedIds.has(id)) this.ownedIds.delete(id); else this.ownedIds.add(id); this.saveData(); },
                getMemberOwnedCount(name) { return this.rawItems.filter(i => i.name === name && this.ownedIds.has(i.id)).length; },
                getProgress(items) { return { count: items.filter(i => this.ownedIds.has(i.id)).length }; },
                saveData() {
                    localStorage.setItem('raw_items', JSON.stringify(this.rawItems));
                    localStorage.setItem('owned_photos', JSON.stringify([...this.ownedIds]));
                    localStorage.setItem('series_images', JSON.stringify(this.seriesImages));
                },
                exportData() {
                    const data = JSON.stringify(localStorage);
                    const blob = new Blob([data], {type: 'text/plain'});
                    const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = `photo_backup.txt`; a.click();
                },
                clearAll() { if(confirm('Clear all data?')) { localStorage.clear(); location.reload(); } }
            }
        }).mount('#app')
    </script>
</body>
</html>