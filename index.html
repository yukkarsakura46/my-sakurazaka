<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAKURAZAKA Collection</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .photo-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; }
        .item-slot {
            aspect-ratio: 2 / 1; 
            display: flex; align-items: center; justify-content: center;
            border-radius: 6px; font-size: 10px; font-weight: 800;
            transition: all 0.2s ease; letter-spacing: -0.5px;
        }
        .expand-enter-active, .expand-leave-active { transition: all 0.25s ease; max-height: 1500px; overflow: hidden; }
        .expand-enter-from, .expand-leave-to { max-height: 0; opacity: 0; }
        .section-header { font-size: 11px; font-weight: 900; color: #94a3b8; letter-spacing: 0.1em; margin: 20px 0 10px 4px; border-left: 3px solid #f472b6; padding-left: 8px; text-transform: uppercase; }
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(4px);
            z-index: 100; display: flex; align-items: center; justify-content: center; padding: 20px;
        }
    </style>
</head>
<body class="bg-slate-50 min-h-screen pb-10 font-sans">
    <div id="app">
        <nav class="bg-white shadow-sm p-4 sticky top-0 z-30 border-b border-gray-100">
            <div class="max-w-xl mx-auto flex justify-between items-center">
                <h1 class="text-2xl font-black text-gray-800 tracking-tighter cursor-pointer italic" @click="currentMember = null">SAKURAZAKA</h1>
                <button @click="showInput = true" class="text-[10px] bg-slate-800 text-white px-4 py-2 rounded-full font-bold shadow-lg active:scale-95 transition tracking-widest">ç®¡ç†é¢æ¿</button>
            </div>
        </nav>

        <div v-if="showInput" class="modal-overlay" @click.self="showInput = false">
            <div class="bg-white w-full max-w-sm p-6 rounded-3xl shadow-2xl border-t-4 border-pink-400 relative">
                <button @click="showInput = false" class="absolute top-4 right-4 text-gray-300 hover:text-gray-500 font-bold">âœ•</button>
                <h3 class="text-lg font-black text-gray-800 mb-4 italic">ç®¡ç†é¢æ¿</h3>
                
                <div class="space-y-3">
                    <select v-model="selectedGen" class="w-full border p-2.5 rounded-xl outline-none focus:ring-2 focus:ring-pink-400 text-sm bg-white font-bold text-gray-700">
                        <option value="">-- 1. é¸æ“‡æœŸåˆ¥ --</option>
                        <option v-for="(members, gen) in presetMembers" :key="gen" :value="gen">{{ gen }}</option>
                    </select>

                    <select v-if="selectedGen" v-model="newItem.name" class="w-full border p-2.5 rounded-xl outline-none focus:ring-2 focus:ring-pink-400 text-sm bg-white font-bold text-gray-700">
                        <option value="">-- 2. é¸æ“‡æˆå“¡ --</option>
                        <option v-for="name in presetMembers[selectedGen]" :key="name" :value="name">{{ name }}</option>
                    </select>

                    <select v-model="selectedCategory" @change="onCategorySelect" class="w-full border p-2.5 rounded-xl outline-none focus:ring-2 focus:ring-pink-400 text-sm bg-white text-gray-700">
                        <option value="">-- 3. é¸æ“‡ç³»åˆ—åˆ†é¡ --</option>
                        <option v-for="(list, cat) in categorizedSeries" :key="cat" :value="cat">{{ cat }}</option>
                        <option value="custom_cat">ï¼‹ æ‰‹å‹•è¼¸å…¥æ–°åˆ†é¡...</option>
                    </select>

                    <select v-if="selectedCategory && selectedCategory !== 'custom_cat'" v-model="selectedPreset" @change="onSeriesSelect" class="w-full border p-2.5 rounded-xl outline-none focus:ring-2 focus:ring-pink-400 text-sm bg-white text-gray-700">
                        <option value="">-- 4. é¸æ“‡å…·é«”ç³»åˆ— --</option>
                        <option v-for="s in categorizedSeries[selectedCategory]" :key="s" :value="s">{{ s }}</option>
                        <option value="custom_series">ï¼‹ æ‰‹å‹•è¼¸å…¥æ–°ç³»åˆ—...</option>
                    </select>

                    <input v-if="selectedCategory === 'custom_cat'" v-model="newItem.category" type="text" placeholder="æ‰‹å‹•è¼¸å…¥åˆ†é¡åç¨±" class="w-full border p-2.5 rounded-xl text-sm">
                    <input v-if="selectedPreset === 'custom_series' || selectedCategory === 'custom_cat'" v-model="newItem.series" type="text" placeholder="æ‰‹å‹•è¼¸å…¥ç³»åˆ—åç¨±" class="w-full border p-2.5 rounded-xl text-sm">
                    
                    <button @click="addBatchItems" class="w-full bg-pink-500 text-white p-3 rounded-xl font-bold text-sm shadow-lg shadow-pink-100 active:scale-95 transition mt-2">ç¢ºèªæ–°å¢ä¸¦è·³è½‰</button>
                </div>
                
                <div class="flex justify-between mt-6 border-t pt-4 gap-2">
                    <div class="flex gap-2">
                        <button @click="exportData" class="text-[10px] text-blue-500 font-bold border border-blue-100 px-3 py-1.5 rounded-lg">å‚™ä»½</button>
                        <label class="text-[10px] text-green-600 font-bold border border-green-100 px-3 py-1.5 rounded-lg cursor-pointer">é‚„åŸ<input type="file" class="hidden" @change="importData" accept=".txt"></label>
                    </div>
                    <button @click="clearAll" class="text-[10px] text-red-300 font-bold px-2">æ¸…ç©º</button>
                </div>
            </div>
        </div>

        <main class="max-w-xl mx-auto p-3">
            <div v-if="!currentMember">
                <div v-for="(members, gen) in presetMembers" :key="gen" class="mb-8">
                    <div v-if="getGenActiveCount(gen) > 0">
                        <h2 class="section-header">{{ gen }}</h2>
                        <div class="grid grid-cols-2 gap-3">
                            <div v-for="name in getActiveMembersInGen(gen)" :key="name" @click="currentMember = name" class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100 active:scale-95 transition text-center" :class="gen === 'ç•¢æ¥­ç”Ÿ' ? 'opacity-70' : ''">
                                <div class="font-black text-gray-700 text-base italic">{{ name }}</div>
                                <div class="text-[9px] font-bold mt-1 uppercase tracking-widest text-pink-400">{{ getMemberOwnedCount(name) }} Collected</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div v-if="!memberList.length" class="text-center py-24 text-slate-300 font-bold italic">
                    <div class="text-3xl mb-4 opacity-20">ğŸŒ¸</div>
                    é»æ“Šå³ä¸Šè§’ ç®¡ç†é¢æ¿ é–‹å§‹å»ºç«‹è³‡æ–™åº«
                </div>
            </div>

            <div v-else>
                <div class="flex flex-col gap-4 mb-6 pt-2">
                    <div class="flex items-center justify-between px-1">
                        <div class="flex items-center gap-2">
                            <button @click="currentMember = null" class="text-gray-400 font-bold text-2xl leading-none px-2">â€¹</button>
                            <div class="relative">
                                <select v-model="currentMember" class="appearance-none bg-transparent font-black text-2xl text-gray-800 italic uppercase outline-none pr-8 cursor-pointer">
                                    <optgroup v-for="(names, gen) in presetMembers" :label="gen" :key="gen">
                                        <option v-for="name in getActiveMembersInGen(gen)" :key="name" :value="name">{{ name }}</option>
                                    </optgroup>
                                </select>
                                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center text-pink-500"><svg class="h-5 w-5 fill-current" viewBox="0 0 20 20"><path d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"/></svg></div>
                            </div>
                        </div>
                        <button @click="toggleAll" class="text-[9px] bg-pink-50 text-pink-500 px-3 py-1.5 rounded-lg font-black uppercase tracking-tighter shadow-sm">{{ allExpanded ? 'æ”¶åˆå…¨éƒ¨' : 'å±•é–‹å…¨éƒ¨' }}</button>
                    </div>
                </div>
                
                <div v-for="(seriesGroup, categoryName) in memberItemsGrouped" :key="categoryName" class="mb-8">
                    <div class="px-2 mb-3"><span class="text-[10px] font-black bg-slate-200 text-slate-500 px-2 py-1 rounded uppercase tracking-widest">{{ categoryName }}</span></div>
                    <div v-for="(items, seriesName) in seriesGroup" :key="seriesName" class="mb-2.5">
                        <div @click="toggleSeries(seriesName)" class="bg-white px-4 py-4 rounded-xl shadow-sm border border-gray-100 flex justify-between items-center cursor-pointer active:bg-gray-50">
                            <div class="flex items-center overflow-hidden">
                                <span class="text-[8px] mr-3 text-pink-400 transition-transform duration-200" :class="{'rotate-90': expandedSeries.has(seriesName)}">â–¶</span>
                                <h3 class="text-xs font-bold text-gray-600 truncate mr-2">{{ seriesName }}</h3>
                            </div>
                            <div class="flex items-center gap-3">
                                <div class="bg-gray-50 px-2.5 py-1 rounded text-[11px] font-black text-pink-400">{{ getProgress(items).count }}/4</div>
                                <button @click.stop="removeSeries(seriesName)" class="text-gray-200 hover:text-red-400 transition"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg></button>
                            </div>
                        </div>
                        <transition name="expand">
                            <div v-if="expandedSeries.has(seriesName)" class="bg-white/40 p-4 rounded-b-2xl border-x border-b border-gray-100 mx-1">
                                <div class="mb-4 relative rounded-xl overflow-hidden bg-slate-100 flex items-center justify-center min-h-[120px]">
                                    <img v-if="seriesImages[currentMember + seriesName]" :src="seriesImages[currentMember + seriesName]" @click="zoomedImg = seriesImages[currentMember + seriesName]" class="w-full h-auto max-h-[450px] object-contain cursor-zoom-in">
                                    <label v-else class="py-8 cursor-pointer w-full text-center"><span class="text-[11px] text-gray-300 font-bold uppercase tracking-widest">+ ä¸Šå‚³å±•ç¤ºåœ–</span><input type="file" class="hidden" @change="(e) => handleSeriesImageUpload(e, currentMember + seriesName)" accept="image/*"></label>
                                </div>
                                <div class="photo-grid px-1 pb-1">
                                    <div v-for="item in items" :key="item.id" @click="toggleItem(item.id)" class="item-slot border-2" :class="ownedIds.has(item.id) ? 'border-pink-500 bg-pink-500 text-white shadow-md' : 'border-gray-100 bg-white text-gray-300'">{{ item.type }}</div>
                                </div>
                            </div>
                        </transition>
                    </div>
                </div>
            </div>
        </main>
        <div v-if="zoomedImg" @click="zoomedImg = null" class="fixed inset-0 bg-black/95 z-[200] flex items-center justify-center p-2"><img :src="zoomedImg" class="max-w-full max-h-full object-contain shadow-2xl"></div>
    </div>

    <script>
        const { createApp } = Vue;
        createApp({
            data() {
                return {
                    presetMembers: {
                        'äºŒæœŸç”Ÿ': ['é è—¤å…‰è‰', 'å¤§åœ’ç²', 'å¤§æ²¼æ™¶ä¿', 'å¹¸é˜ªèŒ‰é‡Œä¹ƒ', 'æ­¦å…ƒå”¯è¡£', 'ç”°æ‘ä¿ä¹ƒ', 'è—¤å‰å¤éˆ´', 'å¢æœ¬ç¶ºè‰¯', 'æ¾ç”°é‡Œå¥ˆ', 'æ£®ç”°ã²ã‹ã‚‹', 'å®ˆå±‹éº—å¥ˆ', 'å±±ï¨‘å¤©'],
                        'ä¸‰æœŸç”Ÿ': ['çŸ³æ£®ç’ƒèŠ±', 'é è—¤ç†å­', 'å°ç”°å€‰éº—å¥ˆ', 'å°å³¶å‡ªç´—', 'è°·å£æ„›å­£', 'ä¸­å¶‹å„ªæœˆ', 'çš„é‡ç¾é’', 'å‘äº•ç´”è‘‰', 'æ‘äº•å„ª', 'æ‘å±±ç¾ç¾½', 'å±±ä¸‹ç³æœˆ'],
                        'å››æœŸç”Ÿ': ['æ·ºäº•æˆ€ä¹ƒæœª', 'ç¨»ç†Šã²ãª', 'å‹åˆæ˜¥', 'ä½è—¤æ„›æ«»', 'ä¸­å·æ™ºå°‹', 'æ¾æœ¬å’Œå­', 'ç›®é»‘é™½è‰²', 'å±±å·å®‡è¡£', 'å±±ç”°æ¡ƒå¯¦'],
                        'ç•¢æ¥­ç”Ÿ': ['æ¾å¹³ç’ƒå­', 'å®ˆå±‹èŒœ', 'æ¸¡é‚Šæ¢¨åŠ ', 'æ¸¡é‚‰ç†ä½', 'åŸç”°è‘µ', 'å°¾é—œæ¢¨é¦™', 'è…äº•å‹é¦™', 'é—œæœ‰ç¾å­', 'åœŸç”Ÿç‘ç©‚', 'å°æ—ç”±ä¾', 'é½‹è—¤å†¬å„ªèŠ±', 'ä¸Šæ‘è‰èœ', 'å°æ± ç¾æ³¢', 'äº•ä¸Šæ¢¨å']
                    },
                    categorizedSeries: {
                        "å°å…¥": ["5th Single ã€Œæ¡œæœˆã€å°å…¥", "6th Single ã€ŒStart over!ã€å°å…¥", "7th Single ã€Œæ‰¿èªæ¬²æ±‚ã€å°å…¥", "8th Single ã€Œä½•æ­³ã®é ƒã«æˆ»ã‚ŠãŸã„ã®ã‹?ã€ å°å…¥", "9th Single ã€Œè‡ªæ¥­è‡ªå¾—ã€å°å…¥", "10th Singleã€Œ I want tomorrow to comeã€å°å…¥", "11th Single ã€ŒUDAGAWA GENERATIONã€å°å…¥", "2nd Album ã€ŒAddictionã€å°å…¥", "12th Single ã€ŒMake or Breakã€å°å…¥", "13th Single ã€ŒUnhappy birthdayæ§‹æ–‡ã€å°å…¥", "14th Single ã€ŒThe growing up trainã€å°å…¥"],
                        "MVè¡£è£": ["ã€Œå¤ã®è¿‘é“ã€ MVè¡£è£…", "ã€Œå¤ã®è¿‘é“ã€ MVåˆ¶æœ", "ã€ŒBANã€ MVè¡£è£…", "ã€Œé™å¯‚ã®æš´åŠ›ã€ MVè¡£è£…", "ã€ŒNobody's faultã€MVè¡£è£…", "ã€Œæ‰¿èªæ¬²æ±‚ã€MVè¡£è£…", "ã€Œãƒãƒ¢ãƒªãƒ“ãƒˆã€ MVè¡£è£…", "ã€Œä½•æ­³ã®é ƒã«æˆ»ã‚ŠãŸã„ã®ã‹?ã€MVè¡£è£…", "ã€Œä½•åº¦ LOVE SONG ã®æ­Œè©ã‚’èª­ã¿è¿”ã—ãŸã ã‚ã†ã€ MVè¡£è£…", "ã€Œæ²¹ã‚’æ³¨ã›!ã€ MVè¡£è£…", "ã€Œè‡ªæ¥­è‡ªå¾—ã€MVè¡£è£…", "ã€Œæ„›ã—åˆã„ãªã•ã„ã€ MV è¡£è£…", "ã€Œå¼•ãã“ã‚‚ã‚‹æ™‚é–“ã¯ãªã„ã€ MV è¡£è£…", "ã€ŒI want tomorrow to comeã€MVè¡£è£…", "ã€Œæœ¬è³ªçš„ãªã“ã¨ã€ MVè¡£è£…", "ã€Œåƒ•ã¯åƒ•ã‚’å¥½ãã«ãªã‚Œãªã„ã€ MVè¡£è£…", "ã€ŒUDAGAWA GENERATIONã€MVè¡£è£…", "ã€ŒNothing Specialã€MVè¡£è£…", "ã€ŒNightmare ç—‡å€™ç¾¤ã€MVè¡£è£…", "ã€ŒAddictionã€ MVè¡£è£…", "ã€ŒMake or Breakã€ MVè¡£è£…", "ã€Œæ¸¯å€ãƒ‘ã‚»ãƒªã€ MVè¡£è£…", "ã€ŒUnhappy birthdayæ§‹æ–‡ã€MVè¡£è£…", "ã€Œæœ¨æ¯ã‚‰ã—ã¯æ³£ã‹ãªã„ã€MVè¡£è£…", "ã€ŒThe growing up trainã€MVè¡£è£…"],
                        "å°é¢ç…§": ["ã€ŒStart over!ã€ ã‚¸ãƒ£ã‚±ãƒƒãƒˆå†™çœŸè¡£è£…", "ã€Œæ‰¿èªæ¬²æ±‚ã€ã‚¸ãƒ£ã‚±ãƒƒãƒˆå†™çœŸè¡£è£…", "ã€Œä½•æ­³ã®é ƒã«æˆ»ã‚ŠãŸã„ã®ã‹?ã€ ã‚¸ãƒ£ã‚±ãƒƒãƒˆå†™çœŸè¡£è£…", "ã€Œè‡ªæ¥­è‡ªå¾—ã€ã‚¸ãƒ£ã‚±ãƒƒãƒˆå†™çœŸè¡£è£…", "ã€ŒI want tomorrow to comeã€ã‚¸ãƒ£ã‚±ãƒƒãƒˆå†™çœŸè¡£è£…", "ã€ŒUDAGAWA GENERATIONã€ã‚¸ãƒ£ã‚±ãƒƒãƒˆå†™çœŸè¡£è£…", "ã€ŒMake or Breakã€ã‚¸ãƒ£ã‚±ãƒƒãƒˆå†™çœŸè¡£è£…", "ã€ŒUnhappy birthdayæ§‹æ–‡ã€ã‚¸ãƒ£ã‚±ãƒƒãƒˆå†™çœŸè¡£è£…", "ã€ŒThe growing up trainã€ã‚¸ãƒ£ã‚±ãƒƒãƒˆå†™çœŸè¡£è£…"],
                        "LIVEè¡£è£": ["ä¸‰æœŸç”Ÿãƒ–ãƒƒã‚¯ãƒ¬ãƒƒãƒˆè¡£è£…", "ã€Œ3rd TOUR 2023ã€ ã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°è¡£è£…", "ã€Œ3rd TOUR 2023ã€ ç™½ã‚¹ãƒ¼ãƒ„è¡£è£…", "2023å¹´å¤ãƒ•ã‚§ã‚¹è¡£è£…", "3rd Single BACKS LIVE!!", "ã€Œ3rd TOUR 2023ã€ ãƒ”ãƒ³ã‚¯è¡£è£…", "ã€Œ3rd YEAR ANNIVERSARY LIVEã€ ãƒ©ã‚¤ãƒ–è¡£è£…", "ã€Œ7th Single BACKS LIVE!!ã€ ã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°è¡£è£…", "ã€Œå°æ—ç”±ä¾ ç•¢æ¥­æ¼”å”±æœƒã€ ãƒ©ã‚¤ãƒ–è¡£è£…", "ã€Œå°æ—ç”±ä¾ ç•¢æ¥­æ¼”å”±æœƒã€ èµ¤è¡£è£…", "ã€Œ3rd TOUR 2023ã€ ãƒ©ã‚¤ãƒ–è¡£è£…", "2023å¹´ å¹´æœ«æ­Œå”±è¡£è£…", "ã€Œ8th Single BACKS LIVE!!ã€ å…§å®¹", "ã€Œ4th ARENA TOUR 2024ã€ å…§å®¹", "ã€Œ3rd YEAR ANNIVERSARY LIVEã€ å…§å®¹", "ã€Œ4th ARENA TOUR IN æ±äº¬ãƒ‰ãƒ¼ãƒ ã€ å…§å®¹", "ã€Œ9th Single BACKS LIVE!!ã€ å…§å®¹", "2023å¹´ å¹´æœ«è¡£è£…", "2024å¹´å¤ãƒ•ã‚§ã‚¹è¡£è£…", "ã€Œ4th ARENA TOURã€ å…§å®¹", "ã€Œ4th YEAR ANNIVERSARY LIVEã€ å…§å®¹", "ã€Œ4th ARENA TOURã€ å…§å®¹", "ã€Œä¸‰æœŸç”Ÿãƒ©ã‚¤ãƒ–ã€ å…§å®¹", "ã€Œ4th ARENA TOUR IN æ±äº¬ãƒ‰ãƒ¼ãƒ ã€ å…§å®¹", "ã€Œ10th Single BACKS LIVE!!ã€ å…§å®¹", "ã€Œ5th TOUR 2025 Addictionã€ å…§å®¹", "ã€Œä¸‰æœŸç”Ÿãƒ©ã‚¤ãƒ–ã€è¡£è£…", "ã€Œ12th Single BACKS LIVE!!ã€å…§å®¹", "ã€Œ5th TOUR 2025 Addictionã€é»‘è¡£è£…", "ã€Œ12th Single BACKS LIVE!!ã€é»‘è¡£è£…"],
                        "å…¶ä»–": ["2023å¹´ å†¬ç§æœã‚³ãƒ¼ãƒ‡", "ã‚¹ãƒ¼ãƒ„ã‚³ãƒ¼ãƒ‡", "ã‚«ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‡", "ã‚µãƒãƒ¼ãƒ¯ãƒ³ãƒ”ãƒ¼ã‚¹", "ãƒ‡ãƒ‹ãƒ ã‚³ãƒ¼ãƒ‡", "2023å¹´ ãƒãƒ­ã‚¦ã‚£ãƒ³è¡£è£…", "2023å¹´ ã‚¯ãƒªã‚¹ãƒã‚¹ã‚µãƒ³ã‚¿è¡£è£…", "2023å¹´ èª­æ›¸ã‚³ãƒ¼ãƒ‡", "2024å¹´ æŒ¯è¢–è¡£è£…", "ãŠã†ã¡ã‚³ãƒ¼ãƒ‡", "ã‚¸ãƒ£ãƒ³ãƒ—ã‚¹ãƒ¼ãƒ„", "2024å¹´ æ˜¥ç§æœã‚³ãƒ¼ãƒ‡", "ã‚«ãƒ©ãƒ¼ãƒ‡ãƒ‹ãƒ ", "2024å¹´æµ´è¡£", "éº¥ã‚ã‚‰å¸½å­ã‚³ãƒ¼ãƒ‡", "Tã‚·ãƒ£ãƒ„ã‚³ãƒ¼ãƒ‡", "ãƒ¯ã‚¤ã‚·ãƒ£ãƒ„ã‚³ãƒ¼ãƒ‡", "2024å¹´ ãƒãƒ­ã‚¦ã‚£ãƒ³è¡£è£…", "ã‚«ãƒ©ãƒ¼ãƒ‹ãƒƒãƒˆã‚³ãƒ¼ãƒ‡", "2024å¹´ ã‚¯ãƒªã‚¹ãƒã‚¹ã‚µãƒ³ã‚¿è¡£è£…", "ã©ã†ã¶ã¤ç€ãã‚‹ã¿", "ãƒãƒ•ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‡", "2025å¹´æŒ¯è¢–", "ã„ã¬ã¿ã¿ã‚³ãƒ¼ãƒ‡", "æ¨¡å¼ã‚³ãƒ¼ãƒ‡", "å†¬ç§æœã‚³ãƒ¼ãƒ‡", "ãƒã‚¯ã‚¿ã‚¤ã‚³ãƒ¼ãƒ‡", "ãƒ¬ã‚¶ãƒ¼ã‚¸ãƒ£ã‚±ãƒƒãƒˆã‚³ãƒ¼ãƒ‡", "2025å¹´æµ´è¡£", "ãƒãƒ­ã‚·ãƒ£ãƒ„ã‚³ãƒ¼ãƒ‡", "ã‚¯ãƒ©ã‚·ãƒƒã‚¯ã‚³ãƒ¼ãƒ‡", "æª¢æŸ¥ã‚³ãƒ¼ãƒ‡", "ãƒ‘ã‚¤ãƒ¬ãƒ¼ãƒ„è¡£è£…", "å†¬æœ", "2025å¹´ ã‚µãƒ³ã‚¿è¡£è£…", "ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°åˆ¶æœ", "2026å¹´ æŒ¯è¢–", "ã‚¸ãƒ£ãƒ¼ã‚¸", "2026å¹´ ãƒãƒ¬ãƒ³ã‚¿ã‚¤ãƒ³ã‚³ãƒ¼ãƒ‡"],
                        "ç‰¹æ®Š": ["ã€ä¼šå ´äºˆç´„ç‰¹å…¸ã€‘ æ±äº¬ãƒ‰ãƒ¼ãƒ é™å®šæˆå“¡ç”Ÿå¯«çœŸ", "æ±äº¬ãƒ‰ãƒ¼ãƒ å®Œè³£å¾¡ç¦®ç´€å¿µ!! ãƒ©ã‚¤ãƒ–æœƒå ´æ’®ã‚ŠãŠã‚ã—ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ç”Ÿå¯«çœŸ", "ç¦è¢‹ 2025 ã€Œ4th ARENA TOUR IN æ±äº¬ãƒ‰ãƒ¼ãƒ ã€ ã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°å…§å®¹", "ç¦è¢‹ 2026 MVå…§å®¹"]
                    },
                    showInput: false, selectedGen: '', selectedCategory: '', selectedPreset: '', currentMember: null, newItem: { name: '', series: '', category: '' }, rawItems: [], ownedIds: new Set(), seriesImages: {}, expandedSeries: new Set(), zoomedImg: null
                }
            },
            computed: {
                memberList() { return [...new Set(this.rawItems.map(i => i.name))]; },
                memberItemsGrouped() {
                    if (!this.currentMember) return {};
                    const filtered = this.rawItems.filter(i => i.name === this.currentMember);
                    const grouped = {};
                    filtered.forEach(item => {
                        const cat = item.category || 'å…¶ä»–';
                        if (!grouped[cat]) grouped[cat] = {};
                        if (!grouped[cat][item.series]) grouped[cat][item.series] = [];
                        grouped[cat][item.series].push(item);
                    });
                    return grouped;
                },
                allExpanded() {
                    const series = [...new Set(this.rawItems.filter(i => i.name === this.currentMember).map(i => i.series))];
                    return series.length > 0 && this.expandedSeries.size === series.length;
                }
            },
            mounted() { this.loadData(); },
            methods: {
                onCategorySelect() { if (this.selectedCategory !== 'custom_cat') this.newItem.category = this.selectedCategory; else this.newItem.category = ''; this.selectedPreset = ''; },
                onSeriesSelect() { if (this.selectedPreset !== 'custom_series') this.newItem.series = this.selectedPreset; else this.newItem.series = ''; },
                toggleSeries(name) { if (this.expandedSeries.has(name)) this.expandedSeries.delete(name); else this.expandedSeries.add(name); },
                toggleAll() {
                    if (this.allExpanded) this.expandedSeries.clear();
                    else [...new Set(this.rawItems.filter(i => i.name === this.currentMember).map(i => i.series))].forEach(s => this.expandedSeries.add(s));
                },
                loadData() {
                    const savedOwned = localStorage.getItem('owned_photos'); if (savedOwned) this.ownedIds = new Set(JSON.parse(savedOwned));
                    const savedItems = localStorage.getItem('raw_items'); if (savedItems) this.rawItems = JSON.parse(savedItems);
                    const savedSeriesImgs = localStorage.getItem('series_images'); if (savedSeriesImgs) this.seriesImages = JSON.parse(savedSeriesImgs);
                },
                saveData() {
                    localStorage.setItem('raw_items', JSON.stringify(this.rawItems));
                    localStorage.setItem('owned_photos', JSON.stringify([...this.ownedIds]));
                    localStorage.setItem('series_images', JSON.stringify(this.seriesImages));
                },
                addBatchItems() {
                    if (!this.newItem.name || !this.newItem.series || !this.newItem.category) return;
                    const target = this.newItem.name; const series = this.newItem.series;
                    ['ãƒ¨ãƒª', 'ãƒãƒ¥ã‚¦', 'ãƒ’ã‚­', 'åº§ã‚Š'].forEach(type => {
                        this.rawItems.push({ id: `id-${Date.now()}-${Math.random()}`, name: target, series: series, category: this.newItem.category, type });
                    });
                    this.saveData(); this.currentMember = target; this.expandedSeries.clear(); this.expandedSeries.add(series);
                    this.showInput = false; this.newItem.series = ''; this.selectedPreset = '';
                },
                removeSeries(seriesName) { if(confirm(`ç¢ºå®šåˆªé™¤æ­¤ç³»åˆ—ï¼Ÿ`)) { this.rawItems = this.rawItems.filter(i => !(i.name === this.currentMember && i.series === seriesName)); this.expandedSeries.delete(seriesName); this.saveData(); } },
                handleSeriesImageUpload(event, key) {
                    const file = event.target.files[0]; if (!file) return;
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const img = new Image(); img.onload = () => {
                            const canvas = document.createElement('canvas'); const MAX_WIDTH = 1000;
                            let width = img.width, height = img.height;
                            if (width > MAX_WIDTH) { height *= MAX_WIDTH / width; width = MAX_WIDTH; }
                            canvas.width = width; canvas.height = height;
                            const ctx = canvas.getContext('2d'); ctx.drawImage(img, 0, 0, width, height);
                            this.seriesImages[key] = canvas.toDataURL('image/jpeg', 0.6); this.saveData();
                        };
                        img.src = e.target.result;
                    };
                    reader.readAsDataURL(file);
                },
                toggleItem(id) { if (this.ownedIds.has(id)) this.ownedIds.delete(id); else this.ownedIds.add(id); this.saveData(); },
                getMemberOwnedCount(name) { return this.rawItems.filter(i => i.name === name && this.ownedIds.has(i.id)).length; },
                getProgress(items) { return { count: items.filter(i => this.ownedIds.has(i.id)).length }; },
                getActiveMembersInGen(gen) { return this.presetMembers[gen].filter(name => this.memberList.includes(name)); },
                getGenActiveCount(gen) { return this.getActiveMembersInGen(gen).length; },
                exportData() {
                    const data = JSON.stringify(localStorage);
                    const blob = new Blob([data], {type: 'text/plain'});
                    const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = `sakura_backup.txt`; a.click();
                },
                importData(event) {
                    const file = event.target.files[0]; if (!file) return;
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const data = JSON.parse(e.target.result);
                            Object.keys(data).forEach(key => localStorage.setItem(key, data[key]));
                            location.reload();
                        } catch (err) { alert('é‚„åŸå¤±æ•—'); }
                    };
                    reader.readAsText(file);
                },
                clearAll() { if(confirm('è­¦å‘Šï¼šé€™å°‡æ¸…ç©ºæ‰€æœ‰è³‡æ–™ï¼')) { localStorage.clear(); location.reload(); } }
            }
        }).mount('#app')
    </script>
</body>
</html>